cellLine_RNA = colnames(RNA_filtered_RWR)
load("~/GitHub/TNBC_PGx/TNBC-PGx_analysis.RData")
pairsOnly = T
cellLine_drug = colnames(Drug_all)
drugnames = row.names(Drug_all)
cellLine_RNA = colnames(RNA_filtered_RWR)
genenames = row.names(RNA_filtered_RWR)
all_samples = intersect(cellLine_drug,cellLine_RNA)
Pairs = Meta_all %>% count(PiD)
library("readxl")
Base_dir = "D:\\Users\\rpowell\\Documents\\GitHub\\TNBC_PGx"
knitr::opts_knit$set(root.dir = Base_dir)
setwd(Base_dir)
Drug_all <- read.csv("./data/Drug_AUC.csv",row.names=1)
Drug_meta <- read.csv("./data/Drug_metadata.csv",row.names=1)
RNA_all <- read.csv("./data/RNAseq_COMBAT.csv",row.names=1)
Meta_all <- read_excel("./data/PDX_metadata.xlsx")
PPI = "./data/STRING.csv"
row.names(Meta_all) = Meta_all$PDX_ID
pairsOnly = T
cellLine_drug = colnames(Drug_all)
drugnames = row.names(Drug_all)
cellLine_RNA = colnames(RNA_filtered_RWR)
genenames = row.names(RNA_filtered_RWR)
all_samples = intersect(cellLine_drug,cellLine_RNA)
Pairs = Meta_all %>% count(PiD)
Pairs = Pairs[which(Pairs$n >= 2),]
Meta_pairsOnly = Meta_all[which(Meta_all$PiD %in% Pairs$PiD),]
row.names(Meta_pairsOnly) = Meta_pairsOnly$PDX_ID
if (pairsOnly){
train_samples = intersect(all_samples,Meta_pairsOnly$PDX_ID)
} else{train_samples = all_samples}
train_samples
tmp = setdiff(colnames(RNA_filtered_RWR),train_samples)
test_samples = intersect(colnames(Drug_all),tmp)
unknown_samples = setdiff(tmp,colnames(Drug_all))
with_held_RNA = RNA_filtered_RWR[,test_samples]
with_held_Drug = Drug_all[,test_samples]
with_held_common = intersect(colnames(with_held_RNA),colnames(with_held_Drug))
with_held_RNA = with_held_RNA[,with_held_common]
with_held_Drug = with_held_Drug[,with_held_common]
CCL_corr = cor(as.matrix(RNA_filtered_RWR[,train_samples]),method = c("pearson"))
df_anno = Meta_all[train_samples,]%>%select("Time","PiD")
library("dendextend")
row_dend = as.dendrogram(hclust(dist(CCL_corr)))
row_dend = color_branches(row_dend, k = 8)
hm_anno = HeatmapAnnotation(df = as.data.frame(df_anno),
annotation_name_side = "left",
col=list(
Time=c("X0"="darkolivegreen",
"X1"="darkorange",
"XS"="darkorchid"
),
PiD =c("2"="yellow3",
"3"="wheat3",
"11"="violetred3",
"14"="turquoise3",
"16"="tomato3",
"18"="thistle3",
"19"="tan3",
"20"="steelblue3",
"21"="springgreen3",
"22"="snow3"
)
)
)
HM = Heatmap(CCL_corr,
name = "Pearson",
cluster_rows = row_dend,
cluster_columns = row_dend,
top_annotation = hm_anno,
show_row_names = FALSE)
HM
ord = colnames(Drug_all)
gr = Meta_all[ord,]
test = cor(gr$Log2_FC_3day,t(Drug_all))
r2 = test^2
#get list of correlated and variable drug names
growth_corr = names(r2[,which(r2 > 0.25)])
variable_drugs = names(drug_filter)
library(matrixStats)
drug_range = rowRanges(as.matrix(Drug_all),useNames = TRUE)
drug_range[drug_range < 0] <- 0
drug_range = drug_range[,2]-drug_range[,1]
drug_filter = which(drug_range >= 0.5)
ord = colnames(Drug_all)
gr = Meta_all[ord,]
test = cor(gr$Log2_FC_3day,t(Drug_all))
r2 = test^2
#get list of correlated and variable drug names
growth_corr = names(r2[,which(r2 > 0.25)])
variable_drugs = names(drug_filter)
x = list(Growth_correlated_drugs = growth_corr,
Variable_drug_response = variable_drugs)
library(ggvenn)
ggvenn(x,
fill_color = c("#0073C2FF","#CD534CFF"),
stroke_size = 0.5, set_name_size = 4)
intersect(growth_corr,variable_drugs)
drug_filter = variable_drugs[!(variable_drugs %in% growth_corr)]
drug_filter
CCL_corr = cor(as.matrix(t(scale(t(Drug_all[,train_samples]),center=TRUE, scale=TRUE))),method = c("pearson"))
df_anno = Meta_all[train_samples,]%>%select("Time","PiD")
hm_anno = HeatmapAnnotation(df = as.data.frame(df_anno),
annotation_name_side = "left",
col=list(
Time=c("X0"="darkolivegreen",
"X1"="darkorange",
"XS"="darkorchid"
),
PiD =c("2"="yellow3",
"3"="wheat3",
"11"="violetred3",
"14"="turquoise3",
"16"="tomato3",
"18"="thistle3",
"19"="tan3",
"20"="steelblue3",
"21"="springgreen3",
"22"="snow3"
)
)
)
HM = Heatmap(CCL_corr,
name = "Pearson",
top_annotation = hm_anno,
show_row_names = FALSE)
HM
metadata = Meta_all[train_samples,]
metadata[] <- lapply(metadata, factor)
design = model.matrix(~0+Time+PiD,metadata)
Rx_fit = lmFit(Drug_all[,train_samples],design)
library(edgeR)
metadata = Meta_all[train_samples,]
metadata[] <- lapply(metadata, factor)
design = model.matrix(~0+Time+PiD,metadata)
Rx_fit = lmFit(Drug_all[,train_samples],design)
Rx_fit_eBayesfit = eBayes(Rx_fit,trend = TRUE,robust = TRUE)
Rx_top = topTable(Rx_fit_eBayesfit,coef = "TimeX0" ,adjust.method="fdr",p.value = 0.01, number=Inf)
# cm = makeContrasts(Mid_v_Pre=TimeX1-TimeX0,levels=design)
# Rx_fit_cm = contrasts.fit(Rx_fit,cm)
# Rx_fit_cm_eBayesfit = eBayes(Rx_fit_cm,trend = TRUE,robust = TRUE)
# Rx_top = topTable(Rx_fit_cm_eBayesfit,adjust.method="fdr", number=Inf)
Rx_top
Mid_v_Pre = c()
Pst_v_Pre = c()
for (i in 1:nrow(Drug_all)){
tmp1 = t(Drug_all[i,train_samples])
colnames(tmp1) = "Active"
tmp2 = Meta_all[train_samples,]
tmp3 = cbind(tmp1,tmp2)
tmp4 = tmp3[,c("Active","Time","PiD")]
tmp5 = reshape(tmp4, direction = "wide", idvar = "PiD", timevar = "Time")
tmp6 = tmp5$Active.X1-tmp5$Active.X0
tmp7 = tmp5$Active.XS-tmp5$Active.X0
names(tmp6) = tmp5$PiD
names(tmp7) = tmp5$PiD
Mid_v_Pre = rbind(Mid_v_Pre,tmp6)
Pst_v_Pre = rbind(Pst_v_Pre,tmp7)
}
rm(list = c("tmp1","tmp2","tmp3","tmp4","tmp5","tmp6","tmp7"))
rownames(Mid_v_Pre) = row.names(Drug_all)
Mid_v_Pre = Mid_v_Pre[ , colSums(is.na(Mid_v_Pre)) == 0]
Mid_v_Pre = Mid_v_Pre[rownames(Rx_top),]
rownames(Pst_v_Pre) = row.names(Drug_all)
Pst_v_Pre = Pst_v_Pre[ , colSums(is.na(Pst_v_Pre)) == 0]
Pst_v_Pre = Pst_v_Pre[rownames(Rx_top),]
anno_df = as.data.frame(Drug_meta[row.names(Rx_top),] %>% select("Class","Target"))
rAnno = rowAnnotation(df = anno_df)
hm1 = Heatmap(Mid_v_Pre,
name = "dAUC",
clustering_method_rows = "ward.D2",
column_title = "postNACT-preNACT",
row_split = anno_df$Class,
row_title_rot = 0,
heatmap_legend_param = list(direction = "vertical"))
hm2 = Heatmap(Pst_v_Pre,
name = "dAUC",
column_title = "Surgery-preNACT",
heatmap_legend_param = list(direction = "vertical"))
ht_list = hm1+hm2+rAnno
draw(ht_list,
row_title = "dAUC",
row_title_gp = gpar(col = "black"),
column_title = "Differential drug susceptability",
column_title_gp = gpar(fontsize = 16),
heatmap_legend_side = "right",
annotation_legend_side = "righ")
View(Rx_top)
Mid_v_Pre = c()
Pst_v_Pre = c()
for (i in 1:nrow(Drug_all)){
tmp1 = t(Drug_all[i,train_samples])
colnames(tmp1) = "Active"
tmp2 = Meta_all[train_samples,]
tmp3 = cbind(tmp1,tmp2)
tmp4 = tmp3[,c("Active","Time","PiD")]
tmp5 = reshape(tmp4, direction = "wide", idvar = "PiD", timevar = "Time")
tmp6 = tmp5$Active.X1-tmp5$Active.X0
tmp7 = tmp5$Active.XS-tmp5$Active.X0
names(tmp6) = tmp5$PiD
names(tmp7) = tmp5$PiD
Mid_v_Pre = rbind(Mid_v_Pre,tmp6)
Pst_v_Pre = rbind(Pst_v_Pre,tmp7)
}
rm(list = c("tmp1","tmp2","tmp3","tmp4","tmp5","tmp6","tmp7"))
rownames(Mid_v_Pre) = row.names(Drug_all)
Mid_v_Pre = Mid_v_Pre[ , colSums(is.na(Mid_v_Pre)) == 0]
Mid_v_Pre = Mid_v_Pre[rownames(Rx_top),]
rownames(Pst_v_Pre) = row.names(Drug_all)
Pst_v_Pre = Pst_v_Pre[ , colSums(is.na(Pst_v_Pre)) == 0]
Pst_v_Pre = Pst_v_Pre[rownames(Rx_top),]
anno_df = as.data.frame(Drug_meta[row.names(Rx_top),] %>% select("Class","Target"))
rAnno = rowAnnotation(df = anno_df, show_annotation_name=TRUE)
hm1 = Heatmap(Mid_v_Pre,
name = "dAUC",
clustering_method_rows = "ward.D2",
column_title = "postNACT-preNACT",
row_split = anno_df$Class,
row_title_rot = 0,
heatmap_legend_param = list(direction = "vertical"))
hm2 = Heatmap(Pst_v_Pre,
name = "dAUC",
column_title = "Surgery-preNACT",
heatmap_legend_param = list(direction = "vertical"))
ht_list = hm1+hm2+rAnno
draw(ht_list,
row_title = "dAUC",
row_title_gp = gpar(col = "black"),
column_title = "Differential drug susceptability",
column_title_gp = gpar(fontsize = 16),
heatmap_legend_side = "right",
annotation_legend_side = "righ")
Heatmap(RNA_all)
Heatmap(RNA_all,
show_row_dend = FALSE,
show_column_dend = FALSE,
show_row_names = FALSE,
show_column_names = FALSE,
)
Heatmap(RNA_all,
show_row_dend = FALSE,
show_column_dend = FALSE,
show_row_names = FALSE,
show_column_names = FALSE)
Heatmap(RNA_filtered_RWR,
show_row_dend = FALSE,
show_column_dend = FALSE,
show_row_names = FALSE,
show_column_names = FALSE)
Heatmap(Y_all,
show_row_dend = FALSE,
show_column_dend = FALSE,
show_row_names = FALSE,
show_column_names = FALSE)
Y_all = t(Drug_all[drug_filter,all_samples])
drugnames = colnames(Y_all)
#X_all = t(RNA_filtered[,common])
X_all = t(RNA_filtered_RWR[,all_samples])
Heatmap(Y_all,
show_row_dend = FALSE,
show_column_dend = FALSE,
show_row_names = FALSE,
show_column_names = FALSE)
metadata = Meta_all[train_samples,]
metadata[] <- lapply(metadata, factor)
design = model.matrix(~0+Time+PiD,metadata)
Rx_fit = lmFit(Drug_all[,train_samples],design)
Rx_fit_eBayesfit = eBayes(Rx_fit,trend = TRUE,robust = TRUE)
Rx_top = topTable(Rx_fit_eBayesfit,coef = "TimeX0" ,adjust.method="fdr",p.value = 0.001, number=Inf)
# cm = makeContrasts(Mid_v_Pre=TimeX1-TimeX0,levels=design)
# Rx_fit_cm = contrasts.fit(Rx_fit,cm)
# Rx_fit_cm_eBayesfit = eBayes(Rx_fit_cm,trend = TRUE,robust = TRUE)
# Rx_top = topTable(Rx_fit_cm_eBayesfit,adjust.method="fdr", number=Inf)
Rx_top
Mid_v_Pre = c()
Pst_v_Pre = c()
for (i in 1:nrow(Drug_all)){
tmp1 = t(Drug_all[i,train_samples])
colnames(tmp1) = "Active"
tmp2 = Meta_all[train_samples,]
tmp3 = cbind(tmp1,tmp2)
tmp4 = tmp3[,c("Active","Time","PiD")]
tmp5 = reshape(tmp4, direction = "wide", idvar = "PiD", timevar = "Time")
tmp6 = tmp5$Active.X1-tmp5$Active.X0
tmp7 = tmp5$Active.XS-tmp5$Active.X0
names(tmp6) = tmp5$PiD
names(tmp7) = tmp5$PiD
Mid_v_Pre = rbind(Mid_v_Pre,tmp6)
Pst_v_Pre = rbind(Pst_v_Pre,tmp7)
}
rm(list = c("tmp1","tmp2","tmp3","tmp4","tmp5","tmp6","tmp7"))
rownames(Mid_v_Pre) = row.names(Drug_all)
Mid_v_Pre = Mid_v_Pre[ , colSums(is.na(Mid_v_Pre)) == 0]
Mid_v_Pre = Mid_v_Pre[rownames(Rx_top),]
rownames(Pst_v_Pre) = row.names(Drug_all)
Pst_v_Pre = Pst_v_Pre[ , colSums(is.na(Pst_v_Pre)) == 0]
Pst_v_Pre = Pst_v_Pre[rownames(Rx_top),]
anno_df = as.data.frame(Drug_meta[row.names(Rx_top),] %>% select("Class","Target"))
rAnno = rowAnnotation(df = anno_df, show_annotation_name=TRUE)
hm1 = Heatmap(Mid_v_Pre,
name = "dAUC",
clustering_method_rows = "ward.D2",
column_title = "postNACT-preNACT",
row_split = anno_df$Class,
row_title_rot = 0,
heatmap_legend_param = list(direction = "vertical"))
hm2 = Heatmap(Pst_v_Pre,
name = "dAUC",
column_title = "Surgery-preNACT",
heatmap_legend_param = list(direction = "vertical"))
ht_list = hm1+hm2+rAnno
draw(ht_list,
row_title = "dAUC",
row_title_gp = gpar(col = "black"),
column_title = "Differential drug susceptability",
column_title_gp = gpar(fontsize = 16),
heatmap_legend_side = "right",
annotation_legend_side = "righ")
metadata = Meta_all[train_samples,]
metadata[] <- lapply(metadata, factor)
design = model.matrix(~0+Time+PiD,metadata)
Rx_fit = lmFit(Drug_all[,train_samples],design)
Rx_fit_eBayesfit = eBayes(Rx_fit,trend = TRUE,robust = TRUE)
Rx_top = topTable(Rx_fit_eBayesfit,coef = "TimeX0" ,adjust.method="fdr",p.value = 0.005, number=Inf)
# cm = makeContrasts(Mid_v_Pre=TimeX1-TimeX0,levels=design)
# Rx_fit_cm = contrasts.fit(Rx_fit,cm)
# Rx_fit_cm_eBayesfit = eBayes(Rx_fit_cm,trend = TRUE,robust = TRUE)
# Rx_top = topTable(Rx_fit_cm_eBayesfit,adjust.method="fdr", number=Inf)
Rx_top
Mid_v_Pre = c()
Pst_v_Pre = c()
for (i in 1:nrow(Drug_all)){
tmp1 = t(Drug_all[i,train_samples])
colnames(tmp1) = "Active"
tmp2 = Meta_all[train_samples,]
tmp3 = cbind(tmp1,tmp2)
tmp4 = tmp3[,c("Active","Time","PiD")]
tmp5 = reshape(tmp4, direction = "wide", idvar = "PiD", timevar = "Time")
tmp6 = tmp5$Active.X1-tmp5$Active.X0
tmp7 = tmp5$Active.XS-tmp5$Active.X0
names(tmp6) = tmp5$PiD
names(tmp7) = tmp5$PiD
Mid_v_Pre = rbind(Mid_v_Pre,tmp6)
Pst_v_Pre = rbind(Pst_v_Pre,tmp7)
}
rm(list = c("tmp1","tmp2","tmp3","tmp4","tmp5","tmp6","tmp7"))
rownames(Mid_v_Pre) = row.names(Drug_all)
Mid_v_Pre = Mid_v_Pre[ , colSums(is.na(Mid_v_Pre)) == 0]
Mid_v_Pre = Mid_v_Pre[rownames(Rx_top),]
rownames(Pst_v_Pre) = row.names(Drug_all)
Pst_v_Pre = Pst_v_Pre[ , colSums(is.na(Pst_v_Pre)) == 0]
Pst_v_Pre = Pst_v_Pre[rownames(Rx_top),]
anno_df = as.data.frame(Drug_meta[row.names(Rx_top),] %>% select("Class","Target"))
rAnno = rowAnnotation(df = anno_df, show_annotation_name=TRUE)
hm1 = Heatmap(Mid_v_Pre,
name = "dAUC",
clustering_method_rows = "ward.D2",
column_title = "postNACT-preNACT",
row_split = anno_df$Class,
row_title_rot = 0,
heatmap_legend_param = list(direction = "vertical"))
hm2 = Heatmap(Pst_v_Pre,
name = "dAUC",
column_title = "Surgery-preNACT",
heatmap_legend_param = list(direction = "vertical"))
ht_list = hm1+hm2+rAnno
draw(ht_list,
row_title = "dAUC",
row_title_gp = gpar(col = "black"),
column_title = "Differential drug susceptability",
column_title_gp = gpar(fontsize = 16),
heatmap_legend_side = "right",
annotation_legend_side = "righ")
metadata = Meta_all[train_samples,]
metadata[] <- lapply(metadata, factor)
design = model.matrix(~0+Time+PiD,metadata)
Rx_fit = lmFit(Drug_all[,train_samples],design)
Rx_fit_eBayesfit = eBayes(Rx_fit,trend = TRUE,robust = TRUE)
Rx_top = topTable(Rx_fit_eBayesfit,coef = "TimeX0" ,adjust.method="fdr",p.value = 0.001, number=Inf)
# cm = makeContrasts(Mid_v_Pre=TimeX1-TimeX0,levels=design)
# Rx_fit_cm = contrasts.fit(Rx_fit,cm)
# Rx_fit_cm_eBayesfit = eBayes(Rx_fit_cm,trend = TRUE,robust = TRUE)
# Rx_top = topTable(Rx_fit_cm_eBayesfit,adjust.method="fdr", number=Inf)
Rx_top
Mid_v_Pre = c()
Pst_v_Pre = c()
for (i in 1:nrow(Drug_all)){
tmp1 = t(Drug_all[i,train_samples])
colnames(tmp1) = "Active"
tmp2 = Meta_all[train_samples,]
tmp3 = cbind(tmp1,tmp2)
tmp4 = tmp3[,c("Active","Time","PiD")]
tmp5 = reshape(tmp4, direction = "wide", idvar = "PiD", timevar = "Time")
tmp6 = tmp5$Active.X1-tmp5$Active.X0
tmp7 = tmp5$Active.XS-tmp5$Active.X0
names(tmp6) = tmp5$PiD
names(tmp7) = tmp5$PiD
Mid_v_Pre = rbind(Mid_v_Pre,tmp6)
Pst_v_Pre = rbind(Pst_v_Pre,tmp7)
}
rm(list = c("tmp1","tmp2","tmp3","tmp4","tmp5","tmp6","tmp7"))
rownames(Mid_v_Pre) = row.names(Drug_all)
Mid_v_Pre = Mid_v_Pre[ , colSums(is.na(Mid_v_Pre)) == 0]
Mid_v_Pre = Mid_v_Pre[rownames(Rx_top),]
rownames(Pst_v_Pre) = row.names(Drug_all)
Pst_v_Pre = Pst_v_Pre[ , colSums(is.na(Pst_v_Pre)) == 0]
Pst_v_Pre = Pst_v_Pre[rownames(Rx_top),]
anno_df = as.data.frame(Drug_meta[row.names(Rx_top),] %>% select("Class","Target"))
rAnno = rowAnnotation(df = anno_df, show_annotation_name=TRUE)
hm1 = Heatmap(Mid_v_Pre,
name = "dAUC",
clustering_method_rows = "ward.D2",
column_title = "postNACT-preNACT",
row_split = anno_df$Class,
row_title_rot = 0,
heatmap_legend_param = list(direction = "vertical"))
hm2 = Heatmap(Pst_v_Pre,
name = "dAUC",
column_title = "Surgery-preNACT",
heatmap_legend_param = list(direction = "vertical"))
ht_list = hm1+hm2+rAnno
draw(ht_list,
row_title = "dAUC",
row_title_gp = gpar(col = "black"),
column_title = "Differential drug susceptability",
column_title_gp = gpar(fontsize = 16),
heatmap_legend_side = "right",
annotation_legend_side = "righ")
Mid_v_Pre = c()
Pst_v_Pre = c()
for (i in 1:nrow(Drug_all)){
tmp1 = t(Drug_all[i,train_samples])
colnames(tmp1) = "Active"
tmp2 = Meta_all[train_samples,]
tmp3 = cbind(tmp1,tmp2)
tmp4 = tmp3[,c("Active","Time","PiD")]
tmp5 = reshape(tmp4, direction = "wide", idvar = "PiD", timevar = "Time")
tmp6 = tmp5$Active.X1-tmp5$Active.X0
tmp7 = tmp5$Active.XS-tmp5$Active.X0
names(tmp6) = tmp5$PiD
names(tmp7) = tmp5$PiD
Mid_v_Pre = rbind(Mid_v_Pre,tmp6)
Pst_v_Pre = rbind(Pst_v_Pre,tmp7)
}
rm(list = c("tmp1","tmp2","tmp3","tmp4","tmp5","tmp6","tmp7"))
rownames(Mid_v_Pre) = row.names(Drug_all)
Mid_v_Pre = Mid_v_Pre[ , colSums(is.na(Mid_v_Pre)) == 0]
Mid_v_Pre = Mid_v_Pre[rownames(Rx_top),]
rownames(Pst_v_Pre) = row.names(Drug_all)
Pst_v_Pre = Pst_v_Pre[ , colSums(is.na(Pst_v_Pre)) == 0]
Pst_v_Pre = Pst_v_Pre[rownames(Rx_top),]
anno_df = as.data.frame(Drug_meta[row.names(Rx_top),] %>% select("Class","Target"))
rAnno = rowAnnotation(df = anno_df, show_annotation_name=TRUE)
hm1 = Heatmap(Mid_v_Pre,
name = "dAUC",
clustering_method_rows = "ward.D2",
column_title = "postNACT-preNACT",
row_split = anno_df$Class,
row_title_rot = 0,
heatmap_legend_param = list(direction = "vertical"))
hm2 = Heatmap(Pst_v_Pre,
name = "dAUC",
column_title = "Surgery-preNACT",
heatmap_legend_param = list(direction = "vertical"))
ht_list = hm1+hm2+rAnno
draw(ht_list,
row_title = "dAUC",
row_title_gp = gpar(col = "black"),
column_title = "Differential drug susceptability",
column_title_gp = gpar(fontsize = 16),
heatmap_legend_side = "right",
annotation_legend_side = "righ")
library("stringr")
library("pathfindR")
pathfindR_drug_list = list()
files = list.files(path="./MODEL_20220705/Importance/",
pattern = ".csv",
full.names = TRUE)
for(file in files){
flnm = str_replace(str_remove(basename(file),".csv"),' ','')
save_as = paste("./MODEL_20220705/pathfindR",flnm,sep="/")
drug_of_interest <- read.csv(file)
drug_of_interest = drug_of_interest[,c("X","Overall","pvalue")]
unlink(save_as, recursive = TRUE)
tmp = run_pathfindR(drug_of_interest,iterations = 10,
p_val_threshold = 0.05,
search_method = "GR", #"GR" = Greedy algorythm (Default). "SA" = Simulated annealing, "GA" = Genetic algorythm
plot_enrichment_chart = FALSE,
visualize_enriched_terms = FALSE,
output_dir = save_as,
silent_option = TRUE)
pathfindR_drug_list[[flnm]] = tmp
}
library("caret")
library("ranger")
library("randomForest")
library("doParallel")
cl <- makePSOCKcluster(10)
registerDoParallel(cl)
Model_out = "MODEL_20220707"
Model_out = file.path(Base_dir,Model_out)
library("readxl")
Base_dir = "Q:\\MDA_Helen PiwnicaWorms\\TNBC_PGx"
knitr::opts_knit$set(root.dir = Base_dir)
setwd(Base_dir)
Drug_all <- read.csv("./data/Drug_AUC.csv",row.names=1)
Drug_meta <- read.csv("./data/Drug_metadata.csv",row.names=1)
RNA_all <- read.csv("./data/RNAseq_COMBAT.csv",row.names=1)
Meta_all <- read_excel("./data/PDX_metadata.xlsx")
PPI = "./data/STRING.csv"
row.names(Meta_all) = Meta_all$PDX_ID
